<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: observe.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: observe.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Observable interface
 * @module
 * @see module:tools
 */
 import {
	buildProperty,
	injectProperties
} from "./tools.js"

/**
 * Identifier the property for storing event handlers
 * @constant
 */
export const OBSERVERS = Symbol("observers")

/**
 * Interface definition
 * @interface observable
 */
const HANDLERS = {
	on,
	once,
	off,
	fire
}

/**
 * Interface definition
 * @lends observable
 */
export function observable() {
	return injectProperties.call(this, HANDLERS)
}
export default observable

/**
 * Builds the event list if not exist
 * @private
 * @param events
 * @function
 */
function check(events) {
	buildProperty.call(this, OBSERVERS, {})
	events = events.split(" ")
	events.forEach(e => this[OBSERVERS][e] = this[OBSERVERS][e] || [])
	return events
}

/**
 * Append one or more handlers to one or more events
 * @param {string} event - one or more space separated events
 * @param {...function} handlers - space separated events
 * @function
 */
function on(event, ...handlers) {
	event = check.call(this, event)
	if(event.length > 1) {
		return event.map(x => this.on(x, ...handlers))
	}
	event = event[0]
	this[OBSERVERS][event] = this[OBSERVERS][event].concat(handlers)
	return handlers
}

/**
 * Append one shot handlers to one or more events
 * @param {string} events - space separated events
 * @param {...function} handlers - space separated events
 * @function
 */
function once(events, ...handlers) {
	return this.on(events, ...handlers.map(x => {
		var handler = function() {
			x.apply(this, arguments)
			this.off(events, handler)
		}
		return handler
	}))
}

/**
 * Remove handlers from one or more events
 * @param {string} events - space separated events
 * @param {...function} handlers - space separated events
 * @function
 */
function off(events, ...f) {
	events = check.call(this, events)
	if(events.length > 1) {
		return events.map(x => this.off(x, ...f))
	}
	const list = this[OBSERVERS][events[0]]
	return f.map(h => delete list[list.indexOf(h)])
}

/**
 * Fire events passing args arguments
 * @param {string} events - space separated events
 * @param {...any} args - arguments for the hendlers
 * @function
 */
function fire(events, ...args) {
	events = check.call(this, events)
	if(events.length > 1) {
		return events.map(x => this.fire(x, ...args))
	}
	return this[OBSERVERS][events].map(x => x.apply(this, args))
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-debug.html">debug</a></li><li><a href="module-dom.html">dom</a></li><li><a href="module-observe.html">observe</a></li><li><a href="module-reactive.html">reactive</a></li><li><a href="module-readable.html">readable</a></li><li><a href="module-test.html">test</a></li><li><a href="module-tools.html">tools</a></li><li><a href="module-utils.html">utils</a></li></ul><h3>Classes</h3><ul><li><a href="module-dom.DomPrinter.html">DomPrinter</a></li></ul><h3>Interfaces</h3><ul><li><a href="module-observe-observable.html">observable</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Oct 17 2019 13:34:05 GMT+0200 (W. Europe Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
