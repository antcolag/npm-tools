<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Tests</title>
	<script type="module" async src="./reactive.js"></script>
	<script type="module" async src="./observe.js"></script>
	<script type="module" async src="./tools.js"></script>
	<script type="module" async src="./test.js"></script>
	<script type="module" async src="./utils.js"></script>
	<script type="module" async src="./readable.js"></script>
	<script type="module" async src="./dom.js"></script>
	<script type="module" defer>
		import Test from "./test.js";
		import * as dom from "./dom.js";
		import readable from "./readable.js";
		import {lisperato} from "./tools.js";
		import {
			apply,
			pipe,
			yes
		} from "./utils.js";
		import {
			croak,
			ASSERT,
			ASSERT_T,
			ASSERT_F,
		} from "./debug.js";

		new Test("tests shuld work", async function (arg) {
			var emmet1 = dom.emmet `a#ciao[bella="ola"]>bella.pe#tutti+
				#e+.pure*2>(agli#altri+mhu#ah.ua[sdfd="dsf"]>{text}+ha)*3^^ ^^ ^   ^^(O_o)^^  ^ ^^^ale`
			var emmet2 = dom.emmet `section>div>pre{emmet geterated}^${document.querySelector('h1')}+p{with fun}+ul>.azz*3`
			window.aa = emmet1
			window.ab = emmet2
			console.log(emmet1);
			document.body.appendChild(emmet2)

			//await new Test(
			//	"lisper...",
			//	(x, finder , ...[first, second]) => lisperato.exec(lisperato.l(
			//		(s)=> lisperato.l(lisperato.l(first, lisperato.l(second, x))),
			//		(s)=> lisperato[finder](s)
			//	)) == x
			//).run(Infinity, 'cadadar', 1,2)
			//var tests = new Test(
			//	"reactive and events shuld work",
			//	pipe
			//)
			//tests.bind("result", this, "reactiveResult")
			//tests.on(
			//	"PASSED FAILED complete",
			//	ASSERT.bind(null, this.reactiveResult, tests.result)
			//)
			//await tests.run(true)
//
			//await new Test(
			//	"failing tests shuld work",
			//	croak
			//).die(true)
//
			//await new Test(
			//	"shuld fail if description is not a String",
			//	() => new Test(-1).run()
			//).die(true)
//
			//readable.call(console)
			//var i = 0;
			//var timer = setInterval(()=>{
			//	console.log(`...${++i}`)
			//}, 1000)
			//await new Test(
			//	"readable shuld work (5 sec timer)",
			//	pipe
			//).run(await console.read(2000))
			//;
			//clearInterval(timer)
			//;
//
			//var emmet1 = dom.emmet `a#ciao[bella="ola"]>bella.pe#tutti+
			//	#e+.pure*2>(agli#altri+mhu#ah.ua[sdfd="dsf"]>{text}+ha)*3^^ ^^ ^   ^^(O_o)^^  ^ ^^^ale`
			//var emmet2 = dom.emmet `section>div>pre{emmet geterated}^(${document.querySelector('h1')}[data-pippo="99"]>span.n-\${!}*3)+p{with fun}+ul>.azz*3`
			//window.aa = emmet1
			//window.ab = emmet2
			//console.log(emmet1);
			//document.body.appendChild(emmet2)
			//console.log(dom.emmet `div.c-${$@3}*3`);
			document.body.appendChild(dom.emmet `div.c-\${$@3}*3`)

			try {
				return arg
			} finally {
				await new Test(
					"easter egg",
					(x, finder , ...[first, second]) => lisperato.car(lisperato.exec(lisperato.l(
						(s)=> lisperato.l(lisperato.l(first, lisperato.l(second, x))),
						(s)=> lisperato[finder](s)
					)))
				).run('abra', 'cadadr', 1,2)
			}
		}).run(true)

		window.dom = dom
	</script>
</head>
<body>
	<h1>Tests</h1>
	<p>open the console</p>

	<div class="1">3</div>
	<div class="2">4</div>
	<div class="3">5</div>
</body>
</html>